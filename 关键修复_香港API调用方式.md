# ğŸ”§ å…³é”®ä¿®å¤ï¼šé¦™æ¸¯APIè°ƒç”¨æ–¹å¼

## âŒ ä¹‹å‰çš„é—®é¢˜

### é”™è¯¯çš„è°ƒç”¨æ–¹å¼ï¼š
```
6ä¸ªäº§å“ Ã— 6ä¸ªé—¨åº— = 36æ¬¡APIè°ƒç”¨
```

**ç»“æœï¼š**
- âŒ ç«‹å³è§¦å‘HTTP 541ï¼ˆAPIé™åˆ¶ï¼‰
- âŒ æ‰€æœ‰æŸ¥è¯¢å¤±è´¥
- âŒ æ— æ³•è·å–ä»»ä½•åº“å­˜ä¿¡æ¯

### æ—¥å¿—æ˜¾ç¤ºï¼š
```
15:53:08 - WARNING - åº“å­˜æŸ¥è¯¢å¤±è´¥: HTTP 541
15:53:09 - WARNING - åº“å­˜æŸ¥è¯¢å¤±è´¥: HTTP 541
15:53:10 - WARNING - âš ï¸  è¿ç»­3æ¬¡é‡åˆ°APIé™åˆ¶ï¼
```

---

## âœ… ä¿®å¤åçš„æ–¹å¼

### æ­£ç¡®çš„è°ƒç”¨æ–¹å¼ï¼š
```
6ä¸ªäº§å“ Ã— 1æ¬¡æŸ¥è¯¢ = 6æ¬¡APIè°ƒç”¨
```

**å…³é”®æ”¹è¿›ï¼š**
- âœ… é¦™æ¸¯APIä¸€æ¬¡è°ƒç”¨è¿”å›æ‰€æœ‰é—¨åº—
- âœ… ä¸éœ€è¦å¾ªç¯æ¯ä¸ªé—¨åº—
- âœ… å¤§å¹…å‡å°‘APIè°ƒç”¨æ¬¡æ•°ï¼ˆ83%å‡å°‘ï¼‰
- âœ… é¿å…è§¦å‘APIé™åˆ¶

---

## ğŸ” æŠ€æœ¯ç»†èŠ‚

### é¦™æ¸¯APIç‰¹ç‚¹ï¼š

**URL:**
```
https://www.apple.com/hk-zh/shop/fulfillment-messages
```

**å‚æ•°:**
```python
{
    'fae': 'true',
    'little': 'false',
    'parts.0': 'MFYP4ZA/A',  # Part Number
    'mts.0': 'regular',
    'mts.1': 'sticky',
    'fts': 'true'
}
```

**å“åº”ç»“æ„:**
```json
{
  "body": {
    "PickupMessage": {
      "stores": [
        {"storeNumber": "R409", "availableNow": true, ...},
        {"storeNumber": "R428", "availableNow": false, ...},
        {"storeNumber": "R485", "availableNow": false, ...},
        {"storeNumber": "R499", "availableNow": true, ...},
        {"storeNumber": "R610", "availableNow": false, ...},
        {"storeNumber": "R673", "availableNow": true, ...}
      ]
    }
  }
}
```

**å…³é”®ï¼š** ä¸€æ¬¡è°ƒç”¨å°±è¿”å›**æ‰€æœ‰6ä¸ªé—¨åº—**çš„åº“å­˜ä¿¡æ¯ï¼

---

## ğŸ“Š æ•ˆç‡å¯¹æ¯”

| æ–¹å¼ | äº§å“ | é—¨åº— | APIè°ƒç”¨ | æ€»æ—¶é—´ | é¢‘ç‡ | ç»“æœ |
|------|------|------|---------|--------|------|------|
| **ä¿®å¤å‰** | 6 | 6 | 36æ¬¡ | ~36ç§’ | 36æ¬¡/åˆ† | âŒ è§¦å‘é™åˆ¶ |
| **ä¿®å¤å** | 6 | 6 | 6æ¬¡ | ~12ç§’ | 6æ¬¡/åˆ† | âœ… æ­£å¸¸å·¥ä½œ |

**æ”¹è¿›ï¼š**
- ğŸš€ APIè°ƒç”¨å‡å°‘ **83%**
- âš¡ æŸ¥è¯¢é€Ÿåº¦æå‡ **66%**
- âœ… å®Œå…¨é¿å…APIé™åˆ¶

---

## ğŸ¯ ä»£ç ä¿®æ”¹

### ä¿®æ”¹çš„æ–‡ä»¶ï¼š
`apple_store_monitor_enhanced.py`

### ä¿®æ”¹çš„æ–¹æ³•ï¼š
`check_multiple_products()`

### å…³é”®é€»è¾‘ï¼š

```python
# é¦™æ¸¯APIï¼šä¸€æ¬¡æŸ¥è¯¢è¿”å›æ‰€æœ‰é—¨åº—
if self.region == 'HK':
    logger.info(f"é¦™æ¸¯åŒºåŸŸï¼šä½¿ç”¨ä¼˜åŒ–æŸ¥è¯¢ï¼ˆæ¯ä¸ªäº§å“ä¸€æ¬¡APIè°ƒç”¨ï¼‰")
    
    for i, product in enumerate(products, 1):
        part_number = product.get('part_number')
        product_name = product.get('name', part_number)
        logger.info(f"[{i}/{len(products)}] æ£€æŸ¥å•†å“: {product_name}")
        
        # âœ… ä¸€æ¬¡è°ƒç”¨è¿”å›æ‰€æœ‰é—¨åº—
        result = self.check_product_availability(part_number, None)
        
        # å¤„ç†ç»“æœ...
        all_stores = result.get('stores', {})  # åŒ…å«æ‰€æœ‰6ä¸ªé—¨åº—
        available_stores = [s for s in all_stores.values() if s.get('available')]
        
        # äº§å“é—´å»¶è¿Ÿ2ç§’
        if i < len(products):
            self._interruptible_sleep(2)
```

---

## ğŸš€ ç°åœ¨å¯ä»¥é‡è¯•äº†

### ä½¿ç”¨æ–¹æ³•ï¼š

```bash
# 1. ç¡®ä¿ä½¿ç”¨é¦™æ¸¯é…ç½®
cp config_hongkong_promax_all.json config.json

# 2. å¯åŠ¨ç›‘æ§
python3 main.py
```

### é¢„æœŸè¾“å‡ºï¼š

```
ğŸŒ ç›‘æ§åŒºåŸŸ: é¦™æ¸¯ (HK)

15:53:07 - INFO - å¼€å§‹ç¬¬ 1 è½®åº“å­˜æ£€æŸ¥...
15:53:07 - INFO - é¦™æ¸¯åŒºåŸŸï¼šä½¿ç”¨ä¼˜åŒ–æŸ¥è¯¢ï¼ˆæ¯ä¸ªäº§å“ä¸€æ¬¡APIè°ƒç”¨ï¼‰
15:53:07 - INFO - [1/6] æ£€æŸ¥å•†å“: iPhone 17 Pro Max 256GB æ·±å¢¨è“è‰²
15:53:08 - INFO - æŸ¥è¯¢æˆåŠŸï¼æ”¶åˆ° 6 ä¸ªé—¨åº—çš„å“åº”
15:53:10 - INFO - [2/6] æ£€æŸ¥å•†å“: iPhone 17 Pro Max 256GB å®‡å®™æ©™è‰²
15:53:11 - INFO - æŸ¥è¯¢æˆåŠŸï¼æ”¶åˆ° 6 ä¸ªé—¨åº—çš„å“åº”
...
```

**å…³é”®æŒ‡æ ‡ï¼š**
- âœ… æ¯ä¸ªäº§å“åªæŸ¥è¯¢ä¸€æ¬¡
- âœ… æ¯æ¬¡è¿”å›6ä¸ªé—¨åº—
- âœ… äº§å“é—´å»¶è¿Ÿ2ç§’
- âœ… 6ä¸ªäº§å“å…±12ç§’å®Œæˆ
- âœ… é¢‘ç‡ï¼š6æ¬¡/åˆ†é’Ÿ

---

## ğŸ“‹ éªŒè¯æ¸…å•

è¿è¡Œååº”è¯¥çœ‹åˆ°ï¼š

- [ ] æ˜¾ç¤º "é¦™æ¸¯åŒºåŸŸï¼šä½¿ç”¨ä¼˜åŒ–æŸ¥è¯¢"
- [ ] æ¯ä¸ªäº§å“æ˜¾ç¤º "[X/6] æ£€æŸ¥å•†å“"
- [ ] æ²¡æœ‰HTTP 541é”™è¯¯
- [ ] æ¯è½®æŸ¥è¯¢åœ¨15ç§’å†…å®Œæˆ
- [ ] æ˜¾ç¤ºæ‰€æœ‰6ä¸ªé—¨åº—çš„å“åº”

---

## ğŸŠ ä¿®å¤å®Œæˆ

**ä¿®å¤æ—¶é—´ï¼š** 2025-10-06  
**ä¿®å¤ç±»å‹ï¼š** å…³é”®æ€§èƒ½ä¼˜åŒ–  
**å½±å“ï¼š** é¦™æ¸¯ç›‘æ§ä»ä¸å¯ç”¨å˜ä¸ºå®Œå…¨å¯ç”¨

**ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼** ğŸš€

