# 🚀 Apple Store 库存监控 - 统一入口使用指南

> **一个入口，支持香港和大陆双区域监控**

---

## ⚡ 快速开始

### 一条命令启动

```bash
python3 main_unified.py
```

### 交互式选择

```
1. 选择区域（香港 或 大陆）
2. 选择配置方案
3. 确认并启动
```

**就这么简单！** ✨

---

## 🌍 支持的区域

### 中国香港 (HK)

**特点：**
- ✅ Part Number格式: `ZA/A`（如 `MFYP4ZA/A`）
- ✅ 6家Apple Store
- ✅ API: `https://www.apple.com/hk-zh/shop/fulfillment-messages`
- ✅ 货币: HKD
- ✅ 语言: zh-HK

**预设配置：**
1. **iPhone 17 Pro Max 优先配置**
   - 3门店 × 3产品(256GB)
   - 3次/分钟 ✅ 非常安全

2. **iPhone 17 Pro Max 平衡配置**
   - 6门店 × 6产品(256GB+512GB)
   - 6次/分钟 ✅ 安全

3. **自定义配置**
   - 使用 `config.json`

---

### 中国大陆 (CN)

**特点：**
- ✅ Part Number格式: `CH/A`（如 `MXUA3CH/A`）
- ✅ 42家Apple Store（示例）
- ✅ API: `https://www.apple.com.cn/shop/retail/pickup-message`
- ✅ 货币: CNY
- ✅ 语言: zh-CN

**预设配置：**
1. **默认配置**
   - 使用 `config.json`

2. **自定义配置**
   - 使用 `config.json`

---

## 📖 使用流程

### 步骤1：启动程序

```bash
cd /Users/kellychen/CodeBuddy/applepick
python3 main_unified.py
```

---

### 步骤2：选择区域

```
请选择监控区域：

  1. 中国大陆 (China Mainland)
     Part Number格式: CH/A
     API: https://www.apple.com.cn/shop/retail/pickup-message

  2. 中国香港 (Hong Kong)
     Part Number格式: ZA/A
     API: https://www.apple.com/hk-zh/shop/fulfillment-messages

请选择 (1-2): 
```

**输入对应数字并回车**

---

### 步骤3：选择配置

**如果选择香港：**

```
请选择配置方案：

  1. iPhone 17 Pro Max 优先配置（香港）
     3门店 × 3产品(256GB) = 3次/分钟

  2. iPhone 17 Pro Max 平衡配置（香港）
     6门店 × 6产品(256GB+512GB) = 6次/分钟

  3. 自定义配置
     使用 config.json

请选择 (1-3): 
```

**输入对应数字并回车**

---

### 步骤4：查看配置摘要

程序会显示：

```
监控配置摘要
======================================================================

  区域: 中国香港 (HK)
  Part Number格式: ZA/A
  货币: HKD
  语言: zh-HK

  监控门店 (6 个):
    • R409 - Causeway Bay
    • R428 - ifc mall
    • R485 - Festival Walk
    • R499 - Canton Road
    • R610 - New Town Plaza
    • R673 - apm Hong Kong

  监控产品 (6 个):
    • MFYP4ZA/A - iPhone 17 Pro Max 256GB 深墨蓝色
    • MFYN4ZA/A - iPhone 17 Pro Max 256GB 宇宙橙色
    • MFYM4ZA/A - iPhone 17 Pro Max 256GB 银色
    • MFYQ4ZA/A - iPhone 17 Pro Max 512GB 银色
    • MFYT4ZA/A - iPhone 17 Pro Max 512GB 宇宙橙色
    • MFYU4ZA/A - iPhone 17 Pro Max 512GB 深墨蓝色

======================================================================
```

---

### 步骤5：确认启动

```
确认启动？(y/n): 
```

**输入 `y` 并回车开始监控**

---

## 🎯 使用场景

### 场景1：监控香港iPhone 17 Pro Max

```bash
python3 main_unified.py
# 选择: 2 (香港)
# 选择: 2 (平衡配置)
# 确认: y
```

---

### 场景2：监控大陆门店

```bash
python3 main_unified.py
# 选择: 1 (大陆)
# 选择: 1 (默认配置)
# 确认: y
```

---

### 场景3：使用自定义配置

**准备自定义 `config.json`：**

```json
{
  "region": "HK",
  "target_stores": ["R409", "R428"],
  "target_products": [
    {"part_number": "MFYP4ZA/A", "name": "256GB 深墨蓝色"}
  ],
  "check_interval": 60
}
```

**启动：**

```bash
python3 main_unified.py
# 选择区域
# 选择: 自定义配置
# 确认: y
```

---

## 🔧 配置文件结构

### 香港配置示例

```json
{
  "region": "HK",
  "mode": "single_store_multi_product",
  "check_interval": 60,
  
  "target_stores": [
    "R409",
    "R428",
    "R499"
  ],
  
  "target_products": [
    {
      "part_number": "MFYP4ZA/A",
      "name": "iPhone 17 Pro Max 256GB 深墨蓝色"
    }
  ],
  
  "notification": {
    "desktop": true,
    "sound": true,
    "log": true
  }
}
```

---

### 大陆配置示例

```json
{
  "region": "CN",
  "check_interval": 60,
  
  "target_stores": [
    "R448",
    "R479"
  ],
  
  "target_products": [
    {
      "part_number": "MXUA3CH/A",
      "name": "iPhone 16 Plus 白色 128GB"
    }
  ],
  
  "notification": {
    "desktop": true,
    "sound": true,
    "log": true
  }
}
```

---

## 📊 区域差异对比

| 特性 | 香港 (HK) | 大陆 (CN) |
|------|-----------|-----------|
| **Part Number** | `XXXXXZA/A` | `XXXXXCH/A` |
| **API端点** | `fulfillment-messages` | `pickup-message` |
| **门店数量** | 6家 | 42+家 |
| **货币** | HKD | CNY |
| **语言** | zh-HK | zh-CN |
| **可用配置** | 2个预设 | 1个预设 |

**⚠️ 重要：不同区域的Part Number不能混用！**

---

## 💡 高级功能

### 功能1：区域自动识别

程序会自动识别配置文件中的 `region` 字段，如果与选择不匹配会提示。

---

### 功能2：配置验证

自动验证：
- ✅ 门店文件是否存在
- ✅ 配置文件是否有效
- ✅ 监控频率是否安全

---

### 功能3：频率计算

自动计算并显示请求频率，标记安全级别：
- 🟢 **< 5次/分钟** - 非常安全
- 🟢 **5-10次/分钟** - 安全
- 🟡 **10-15次/分钟** - 接近上限
- 🔴 **> 15次/分钟** - 可能触发限制

---

## 🗂️ 文件结构

```
applepick/
├── main_unified.py                          ← 统一入口（新）
├── main.py                                  ← 原监控程序
│
├── apple_stores_hongkong.json               ← 香港门店
├── apple_stores_china.json                  ← 大陆门店
│
├── config.json                              ← 当前配置
├── config_hongkong_promax_priority.json     ← 香港优先配置
├── config_hongkong_promax_all.json          ← 香港平衡配置
│
├── iphone17_promax_hongkong_complete.json   ← 香港iPhone型号
├── iphone17_all_models.json                 ← 大陆iPhone型号
│
└── 统一入口使用指南.md                      ← 本文档
```

---

## 🔄 与原程序的关系

### main_unified.py（新）

**优势：**
- ✅ 交互式选择区域
- ✅ 自动加载对应配置
- ✅ 验证配置正确性
- ✅ 显示详细摘要

**适用：** 新用户、需要切换区域

---

### main.py（原）

**优势：**
- ✅ 直接启动，无交互
- ✅ 适合脚本自动化
- ✅ 功能完整

**适用：** 配置固定、自动化脚本

---

## ⚠️ 注意事项

### 重要提醒

1. **Part Number格式**
   - 香港：`ZA/A`
   - 大陆：`CH/A`
   - **不能混用！**

2. **API端点**
   - 不同区域使用不同API
   - 程序会自动选择

3. **监控频率**
   - 注意控制在安全范围
   - 程序会自动计算并提示

4. **门店文件**
   - 确保对应区域的门店文件存在
   - 香港：`apple_stores_hongkong.json`
   - 大陆：`apple_stores_china.json`

---

## 🆘 常见问题

### Q: 如何切换监控区域？

A: 重新运行 `python3 main_unified.py`，选择不同的区域。

---

### Q: 可以同时监控两个区域吗？

A: 需要运行两个程序实例，分别配置不同区域。

---

### Q: 配置文件中的region字段重要吗？

A: 是的！程序会验证此字段，确保配置与选择匹配。

---

### Q: 预设配置可以修改吗？

A: 可以！选择"自定义配置"，编辑 `config.json` 即可。

---

### Q: 如何添加新的预设配置？

A: 编辑 `main_unified.py` 中的 `PRESETS` 字典，添加新配置。

---

## 🚀 快速命令

### 启动统一入口

```bash
python3 main_unified.py
```

---

### 启动原监控程序（大陆）

```bash
python3 main.py
```

---

### 查看配置文件

```bash
# 香港优先配置
cat config_hongkong_promax_priority.json

# 香港平衡配置
cat config_hongkong_promax_all.json

# 当前配置
cat config.json
```

---

### 查看门店信息

```bash
# 香港门店
cat apple_stores_hongkong.json

# 大陆门店
cat apple_stores_china.json
```

---

## ✅ 总结

### 核心优势

1. ✅ **统一入口** - 一个程序支持双区域
2. ✅ **交互式** - 清晰的步骤引导
3. ✅ **自动化** - 自动加载和验证配置
4. ✅ **安全** - 频率计算和安全提示
5. ✅ **灵活** - 支持预设和自定义配置

---

### 下一步

**立即开始：**

```bash
python3 main_unified.py
```

**选择您的区域，开始监控！** 🚀

---

**创建时间：** 2025-10-06  
**版本：** 1.0  
**支持区域：** 香港、大陆  

**祝您使用愉快！** 🎉


