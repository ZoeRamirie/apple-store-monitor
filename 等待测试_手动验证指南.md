# 🔍 香港API手动验证指南

> **由于触发了频率限制，让我们用浏览器手动验证**  
> **这是最准确的方法！**

---

## 🎯 目标

从浏览器中获取：
1. ✅ 真实的API请求URL和参数
2. ✅ 真实的响应JSON结构
3. ✅ 真实的香港门店编号
4. ✅ 正确的Part Number格式

---

## 📝 详细步骤

### 步骤1：打开Apple香港官网

访问：
```
https://www.apple.com/hk/shop/buy-iphone
```

或直接用您提供的链接：
```
https://www.apple.com/hk-zh/shop/fulfillment-messages?fae=true&little=false&parts.0=MFYP4ZA/A&mts.0=regular&mts.1=sticky&fts=true
```

---

### 步骤2：打开开发者工具

**Mac：** `Command + Option + I`  
**Windows：** `F12`

切换到 **Network（网络）** 标签

---

### 步骤3：触发API请求

如果您直接访问fulfillment-messages URL：
- 页面会自动加载数据

如果从iPhone购买页：
1. 选择iPhone型号
2. 选择颜色和容量
3. 点击"查看店内提货情况"
4. 输入地址或选择门店

---

### 步骤4：查找API请求

在Network标签中：
1. 查找 `fulfillment-messages` 请求
2. 点击该请求
3. 查看以下信息：

---

### 步骤5：复制请求信息

#### A. 请求URL

在Headers标签中，复制：
```
Request URL: https://www.apple.com/hk-zh/shop/fulfillment-messages?[参数]
```

请完整复制包括所有参数！

---

#### B. 响应内容

切换到 **Response** 标签：
1. 复制完整的JSON响应
2. 或点击 **Preview** 标签浏览结构

---

### 步骤6：保存数据

将以下内容保存到文件：

**文件1：`real_request.txt`**
```
请求URL：
[粘贴完整URL]

请求参数：
[列出所有参数]
```

**文件2：`real_response.json`**
```json
[粘贴完整JSON响应]
```

---

## 🔍 需要特别关注的信息

### 1. 门店列表位置

在响应JSON中查找：
```json
{
  "body": {
    "content": {
      "pickupMessage": {
        "stores": [
          {
            "storeNumber": "???",  // 👈 真实的门店编号！
            "storeName": "???",
            "city": "???"
          }
        ]
      }
    }
  }
}
```

---

### 2. 门店编号格式

记录所有香港门店的编号：
- 是 R428, R485 这样的格式吗？
- 还是其他格式？

---

### 3. Part Number确认

URL中的Part Number：
- 是 `ZA/A` 结尾吗？
- 还是 `ZP/A` 结尾？

---

## 📋 信息收集清单

请记录以下信息：

### API信息
- [ ] 完整的API URL
- [ ] 所有请求参数
- [ ] HTTP方法（GET/POST）
- [ ] 请求头信息

### 门店信息
- [ ] 总共多少个香港门店
- [ ] 每个门店的编号
- [ ] 每个门店的名称
- [ ] 每个门店的城市/地区

### 产品信息
- [ ] Part Number格式
- [ ] 库存状态字段名
- [ ] 可用性标识

---

## 💾 保存方式

### 方式1：复制粘贴

**请求URL：**
```
[在这里粘贴完整URL]
```

**响应JSON（前100行）：**
```json
[在这里粘贴响应的前100行]
```

---

### 方式2：保存到文件

在开发者工具的Response标签中：
1. 右键点击响应内容
2. 选择 "Copy response"
3. 粘贴到文本编辑器
4. 保存为 `hongkong_real_response.json`

---

## 🎯 关键问题

### 问题1：门店编号是什么？

**我们需要确认：**
```
R428? R485? R499? R644?
或者是其他格式？
```

### 问题2：API是否返回所有门店？

**查看响应：**
```
stores数组中有几个元素？
是4个香港门店？还是更多？
```

### 问题3：Part Number格式？

**确认：**
```
MFYP4ZA/A（ZA/A结尾）✅
还是
MFYP4ZP/A（ZP/A结尾）❓
```

---

## 🔄 完成后

### 将信息提供给我

如果您能提供：

1. **完整的API URL** - 我可以更新代码
2. **响应JSON** - 我可以解析门店信息
3. **门店编号列表** - 我可以更新配置

### 或者

如果您发现：
- ✅ 门店编号确实是R428等
- ✅ API返回所有香港门店
- ✅ Part Number是ZA/A格式

那我们就可以：
1. 更新API端点配置
2. 修改请求参数
3. 更新监控器代码

---

## ⚡ 快速示例

### 如果响应是这样的：

```json
{
  "body": {
    "content": {
      "pickupMessage": {
        "stores": [
          {
            "storeNumber": "R428",
            "storeName": "Apple IFC Mall",
            "city": "中環"
          },
          {
            "storeNumber": "R485",
            "storeName": "Apple Festival Walk",
            "city": "九龍塘"
          }
        ]
      }
    }
  }
}
```

那么：
- ✅ 门店编号确认是R428, R485等
- ✅ API一次返回所有门店
- ✅ 我们的配置基本正确

只需要：
- 更新API端点
- 更新请求参数
- 就可以工作了！

---

## 💡 提示

### 如果看不到API请求

**可能原因：**
- 页面已经加载完成
- 请求在打开开发者工具前已发生

**解决：**
1. 先打开开发者工具
2. 再刷新页面（F5）
3. 或重新触发查询

---

### 如果响应太长

**只需要复制：**
- 响应的前500行
- 或门店列表部分
- 不需要全部

关键是找到门店信息！

---

## 🎉 这将解决所有问题

一旦我们有了真实的响应数据：
- ✅ 100%确认门店编号
- ✅ 100%确认API用法
- ✅ 100%确认请求参数
- ✅ 可以立即修复代码

---

**创建时间：** 2025-10-06  
**状态：** ⏳ 等待手动验证  
**优先级：** 🔴 最高

**👉 请按照上述步骤在浏览器中验证，并告诉我结果！**


